$.fn.extend({mousewheel:function(n){return this.each(function(){var o=this;o.D=0,document.all||/safari/.test(navigator.userAgent.toLowerCase())?o.onmousewheel=function(){o.D=event.wheelDelta,event.returnValue=!1,n&&n.call(o)}:o.addEventListener("DOMMouseScroll",function(t){o.D=t.detail>0?-1:1,t.preventDefault(),n&&n.call(o)},!1)})}}),$.fn.extend({jscroll:function(n){return this.each(function(){function o(){s>p&&(p=s),p>a-f-s&&(p=a-f-s),l.stop().animate({top:p},100);var n=-((p-s)*h/(a-2*s));d.stop().animate({top:n},1e3)}function t(){s>p&&(p=s),p>a-f-s&&(p=a-f-s),l.css({top:p});var n=-((p-s)*h/(a-2*s));d.css({top:n})}n=n||{},n.Bar=n.Bar||{},n.Btn=n.Btn||{},n.Bar.Bg=n.Bar.Bg||{},n.Bar.Bd=n.Bar.Bd||{},n.Btn.uBg=n.Btn.uBg||{},n.Btn.dBg=n.Btn.dBg||{};var e={W:"15px",BgUrl:"",Bg:"#efefef",Bar:{Pos:"up",Bd:{Out:"#b5b5b5",Hover:"#ccc"},Bg:{Out:"#fff",Hover:"#fff",Focus:"orange"}},Btn:{btn:!0,uBg:{Out:"#ccc",Hover:"#fff",Focus:"orange"},dBg:{Out:"#ccc",Hover:"#fff",Focus:"orange"}},Fn:function(){}};n.W=n.W||e.W,n.BgUrl=n.BgUrl||e.BgUrl,n.Bg=n.Bg||e.Bg,n.Bar.Pos=n.Bar.Pos||e.Bar.Pos,n.Bar.Bd.Out=n.Bar.Bd.Out||e.Bar.Bd.Out,n.Bar.Bd.Hover=n.Bar.Bd.Hover||e.Bar.Bd.Hover,n.Bar.Bg.Out=n.Bar.Bg.Out||e.Bar.Bg.Out,n.Bar.Bg.Hover=n.Bar.Bg.Hover||e.Bar.Bg.Hover,n.Bar.Bg.Focus=n.Bar.Bg.Focus||e.Bar.Bg.Focus,n.Btn.btn=void 0!=n.Btn.btn?n.Btn.btn:e.Btn.btn,n.Btn.uBg.Out=n.Btn.uBg.Out||e.Btn.uBg.Out,n.Btn.uBg.Hover=n.Btn.uBg.Hover||e.Btn.uBg.Hover,n.Btn.uBg.Focus=n.Btn.uBg.Focus||e.Btn.uBg.Focus,n.Btn.dBg.Out=n.Btn.dBg.Out||e.Btn.dBg.Out,n.Btn.dBg.Hover=n.Btn.dBg.Hover||e.Btn.dBg.Hover,n.Btn.dBg.Focus=n.Btn.dBg.Focus||e.Btn.dBg.Focus,n.Fn=n.Fn||e.Fn;var r,u=this,c=0,B=0;$(u).css({overflow:"hidden",position:"relative",padding:"0px"});var a=($(u).width(),$(u).height()-1),g=n.W?parseInt(n.W):21,s=1==n.Btn.btn?g:0;null==$(u).children(".jscroll-c").height()&&($(u).wrapInner("<div class='jscroll-c' style='top:0px;z-index:9999;zoom:1;position:relative'></div>"),$(u).children(".jscroll-c").prepend("<div style='height:0px;overflow:hidden'></div>"),$(u).append("<div class='jscroll-e' unselectable='on' style=' height:100%;top:0px;right:0;-moz-user-select:none;position:absolute;overflow:hidden;z-index:10000;'><div class='jscroll-u' style='position:absolute;top:0px;width:100%;left:0;background:blue;overflow:hidden'></div><div class='jscroll-h'  unselectable='on' style='background:green;position:absolute;left:0;-moz-user-select:none;border:1px solid'></div><div class='jscroll-d' style='position:absolute;bottom:0px;width:100%;left:0;background:blue;overflow:hidden'></div></div>"));var d=$(u).children(".jscroll-c"),i=$(u).children(".jscroll-e"),l=i.children(".jscroll-h"),b=i.children(".jscroll-u"),v=i.children(".jscroll-d");document.all&&document.execCommand("BackgroundImageCache",!1,!0),d.css({"padding-right":g}),i.css({width:g,background:n.Bg,"background-image":n.BgUrl}),l.css({top:s,background:n.Bar.Bg.Out,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Out,width:g-2}),b.css({height:s,background:n.Btn.uBg.Out,"background-image":n.BgUrl}),v.css({height:s,background:n.Btn.dBg.Out,"background-image":n.BgUrl}),l.hover(function(){0==B&&$(this).css({background:n.Bar.Bg.Hover,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Hover})},function(){0==B&&$(this).css({background:n.Bar.Bg.Out,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Out})}),b.hover(function(){0==B&&$(this).css({background:n.Btn.uBg.Hover,"background-image":n.BgUrl})},function(){0==B&&$(this).css({background:n.Btn.uBg.Out,"background-image":n.BgUrl})}),v.hover(function(){0==B&&$(this).css({background:n.Btn.dBg.Hover,"background-image":n.BgUrl})},function(){0==B&&$(this).css({background:n.Btn.dBg.Out,"background-image":n.BgUrl})});var h=d.height(),f=(a-2*s)*a/h;10>f&&(f=10);var m=f/6,p=0,k=!1;l.height(f),a>=h?(d.css({padding:0}),i.css({display:"none"})):k=!0,"up"!=n.Bar.Pos&&(p=a-f-s,t()),l.bind("mousedown",function(o){n.Fn&&n.Fn.call(u),B=1,l.css({background:n.Bar.Bg.Focus,"background-image":n.BgUrl});var e=o.pageY,r=parseInt($(this).css("top"));return $(document).mousemove(function(n){p=r+n.pageY-e,t()}),$(document).mouseup(function(){B=0,l.css({background:n.Bar.Bg.Out,"background-image":n.BgUrl,"border-color":n.Bar.Bd.Out}),$(document).unbind()}),!1}),b.bind("mousedown",function(){return n.Fn&&n.Fn.call(u),B=1,b.css({background:n.Btn.uBg.Focus,"background-image":n.BgUrl}),u.timeSetT("u"),$(document).mouseup(function(){B=0,b.css({background:n.Btn.uBg.Out,"background-image":n.BgUrl}),$(document).unbind(),clearTimeout(r),c=0}),!1}),v.bind("mousedown",function(){return n.Fn&&n.Fn.call(u),B=1,v.css({background:n.Btn.dBg.Focus,"background-image":n.BgUrl}),u.timeSetT("d"),$(document).mouseup(function(){B=0,v.css({background:n.Btn.dBg.Out,"background-image":n.BgUrl}),$(document).unbind(),clearTimeout(r),c=0}),!1}),u.timeSetT=function(n){var o=this;"u"==n?p-=m:p+=m,t(),c+=2;var e=500-50*c;0>=e&&(e=0),r=setTimeout(function(){o.timeSetT(n)},e)},i.bind("mousedown",function(t){return n.Fn&&n.Fn.call(u),p=p+t.pageY-l.offset().top-f/2,o(),!1}),$(u).mousewheel(function(){1==k&&(n.Fn&&n.Fn.call(u),this.D>0?p-=m:p+=m,t())})})}});