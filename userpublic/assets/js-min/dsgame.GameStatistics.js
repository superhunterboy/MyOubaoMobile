!function(t,e,n){var i,a={mainPanel:"#J-balls-statistics-panel",lotteryNumDom:"#J-balls-statistics-lotteryNum",multipleDom:"#J-balls-statistics-multiple",amountDom:"#J-balls-statistics-amount",moneyUnitDom:"#J-balls-statistics-moneyUnit",moneyUnitTriggerDom:"#J-balls-statistics-moneyUnit-trigger",moneyUnit:gameConfigData.defaultCoefficient,moneyUnitData:gameConfigData.availableCoefficients,multiple:gameConfigData.defaultMultiple,bonusGroupMax:gameConfigData.maxPrizeGroup},r=t.Games,o={init:function(t){var e=this;r.setCurrentGameStatistics(e),e.panel=$(t.mainPanel),e.moneyUnit=t.moneyUnit,e.multiple=t.multiple,e.lotteryData=[],e.multipleDom=new dsgame.Select({cls:"select-game-statics-multiple",realDom:t.multipleDom,isInput:!0,isCounter:!0,expands:{inputEvent:function(){var t=this;this.getInput().keyup(function(){var n=this.value,i=r.getCurrentGame().getCurrentGameMethod().getId(),a=e.getMoneyUnit(),o=o=0==r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(i,a)?n:r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(i,a);this.value=this.value.replace(/[^\d]/g,""),""!=$.trim(this.value)&&(n=Number(this.value),1>n?this.value=1:n>o&&(this.value=o),t.setValue(this.value))}),this.getInput().blur(function(){var n=this.value,i=r.getCurrentGame().getCurrentGameMethod().getId(),a=e.getMoneyUnit(),o=0==r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(i,a)?n:r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(i,a);this.value=this.value.replace(/[^\d]/g,""),n=Number(this.value),1>n?this.value=1:n>o&&(this.value=o),t.setValue(this.value)})}}}),e.multipleDom.setValue(0==e.multiple?1:e.multiple),e.multipleDom.addEvent("change",function(t,n){var i=Number(n),a=r.getCurrentGame().getCurrentGameMethod().getId(),o=e.getMoneyUnit(),u=0==r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(a,o)?i:r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(a,o);i>u&&(i=u,this.setValue(i)),e.setMultiple(i),e.updateData({lotterys:r.getCurrentGame().getCurrentGameMethod().getLottery(),original:r.getCurrentGame().getCurrentGameMethod().getOriginal()},r.getCurrentGame().getCurrentGameMethod().getName()),$("#J-balls-statistics-multipleNum").text(i)}),e.moneyUnitDom=new dsgame.Select({cls:"select-game-statics-moneyUnitDom",realDom:t.moneyUnitDom}),e.moneyUnitDom.setValue(e.moneyUnit),e.moneyUnitDom.addEvent("change",function(t,n){var i=e.getMultip(),a=r.getCurrentGame().getCurrentGameMethod().getId(),o=Number(n),u=0==r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(a,o)?1:r.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(a,o);i=i>u?u:i,e.setMultipleDom(i),e.setMoneyUnit(Number(n)),e.multipleDom.setMaxValue(u),e.updateData({lotterys:r.getCurrentGame().getCurrentGameMethod().getLottery(),original:r.getCurrentGame().getCurrentGameMethod().getOriginal()},r.getCurrentGame().getCurrentGameMethod().getName())}),e.hidesetMoneyUnitDom();var n=$(t.moneyUnitTriggerDom);e.setMoneyUnitTriggerDom(n),n.on("click","a[data-value]",function(){var t=$(this).data("value");return t&&!$(this).hasClass("current")&&(e.moneyUnitDom.setValue(t),$(this).addClass("current").siblings().removeClass("current")),!1}),$('a[data-value="'+e.moneyUnit+'"]',n).addClass("current");for(var i=r.getCurrentGame().getGameConfig().getInstance().getOptionalPrizes(),o=i.length,u=$(".J-prize-group-slider"),m=$("#J-bonus-select-value"),l=u.find("[data-slider-percent]"),s=u.find("[data-slider-value]"),g=o-1,d=a.bonusGroupMax&&"0"!=a.bonusGroupMax?a.bonusGroupMax:i[o-1].prize_group;g>=0&&!(i[g].prize_group<=d);g--);e.bonusGroup=i,e.prizeSlider=new dsgame.SliderBar({minDom:"[data-slider-sub]",maxDom:"[data-slider-add]",contDom:"[data-slider-cont]",handleDom:"[data-slider-handle]",innerDom:"[data-slider-inner]",minNumDom:"[data-slider-min]",maxNumDom:"[data-slider-max]",parentDom:u,step:1,minBound:0,maxBound:o-1,rangeBound:[0,g],value:g}),e.prizeSlider.addEvent("change",function(){var t=i[this.getValue()].prize_group,n=i[this.getValue()].rate,a=(100*n).toFixed(2)+"%";m.val(t),l.text(a),s.text(t);var r=e.getResultData();r&&r.amount&&e.setRebate(r.amount,n)}),$(function(){e.prizeSlider.setValue(g)}),e.updateData({lotterys:[],original:[]})},getMultipleDom:function(){return this.multipleDom},getMultipleTextDom:function(){return $("#J-balls-statistics-multiple-text")},getMoneyUnitText:function(t){return this.defConfig.moneyUnitData[""+t]},updateData:function(t){var e=this,n=(e.defConfig,t.lotterys?t.lotterys.length:0),i=2,a=e.multiple,o=e.moneyUnit;r.getCurrentGame()&&r.getCurrentGame().getCurrentGameMethod()&&(i=r.getCurrentGame().getGameConfig().getInstance().getOnePriceById(r.getCurrentGame().getCurrentGameMethod().getId())),e.setLotteryData(t),e.setMoneyUnitDom(o),e.setLotteryNumDom(n),e.setAmountDom(e.formatMoney(n*o*a*i)),e.fireEvent("afterUpdate",n,n*o*a*i)},getResultData:function(){var t,e=this,n=r.getCurrentGame().getCurrentGameMethod(),i=e.getLotteryData();return i.lotterys.length<1?{}:(t=r.getCurrentGame().getGameConfig().getInstance().getOnePriceById(n.getId()),{mid:n.getId(),type:n.getName(),original:i.original,lotterys:i.lotterys,moneyUnit:e.moneyUnit,num:i.lotterys.length,multiple:e.multiple,onePrice:t,amount:i.lotterys.length*e.moneyUnit*e.multiple*t,amountText:e.formatMoney(i.lotterys.length*e.moneyUnit*e.multiple*t),prizeGroup:r.getCurrentGame().getGameConfig().getInstance().setOptionalPrizes(),prizeGroupVal:$("#J-balls-statistics-rebate").text()})},setMoneyUnit:function(t){var e=this;e.moneyUnit=t},getMoneyUnit:function(){return this.moneyUnit},getLotteryData:function(){return this.lotteryData},setLotteryData:function(t){var e=this;e.lotteryData=t},formatMoney:function(t){var t=Number(t),e=/(-?\d+)(\d{3})/;for(t=Number.prototype.toFixed?t.toFixed(3):Math.round(100*t)/100,t=""+t;e.test(t);)t=t.replace(e,"$1,$2");return t},getLotteryNumDom:function(){var t=this,e=t.defConfig;return t.lotteryNumDom||(t.lotteryNumDom=$(e.lotteryNumDom))},setLotteryNumDom:function(t){var e=this;e.getLotteryNumDom().html(t)},getMultipleDom:function(){return this.multipleDom},getMultip:function(){var t=this;return t.multiple},setMultipleDom:function(t){var e=this;e.getMultipleDom().setValue(t)},setMultiple:function(t){this.multiple=t},getMoneyUnitDom:function(){return this.moneyUnitDom},setMoneyUnitDom:function(t){var e=this,n=t;a.moneyUnitData[t]&&(n=a.moneyUnitData[t]),e.setMoneyUnit(t),$(".select-game-statics-moneyUnitDom input").val(n)},setMoneyUnitTriggerDom:function(t){this.moneyUnitTriggerDom=t},getMoneyUnitTriggerDom:function(){return this.moneyUnitTriggerDom},triggerMoneyUnit:function(t){var e=this,n=$.Event("click"),i=e.getMoneyUnitTriggerDom();n.target=i.find("a[data-value]").filter(function(){return Number($(this).data("value"))==Number(t)})[0],i.trigger(n)},hidesetMoneyUnitDom:function(){this.moneyUnitDom.hide()},getPrizeSlider:function(){return this.prizeSlider},getPrizeGroup:function(){return this.bonusGroup[this.prizeSlider.getValue()].prize_group},getPrizeGroupRate:function(){return this.bonusGroup[this.prizeSlider.getValue()].rate},setSliderValueByPrizeGroup:function(t){var e=-1;$.each(this.bonusGroup,function(n,i){return i.prize_group==t?e=n:void 0}),this.getPrizeSlider().setValue(e)},setRebate:function(e,n){var i="",a=Math.pow(10,8);if(0>=e||0>=n)i="0.00";else if(e=""+parseFloat(e*n*a/a||0),e=e.split("."),e[1]){var r=""+e[1];r.length>8&&(r=r.slice(0,8)),i=t.util.formatMoney(e[0],0)+"."+r}else i=t.util.formatMoney(e[0],2);$("#J-balls-statistics-rebate").text(i)},getAmountDom:function(){var t=this,e=t.defConfig;return t.amountDom||(t.amountDom=$(e.amountDom))},setAmountDom:function(t){var e=this;e.getAmountDom().html(t)},reSet:function(){{var t=this;t.defConfig}t.multipleDom.setValue(1)}},u=t.Class(o,n);u.defConfig=a,u.getInstance=function(t){return i||(i=new u(t))},t[e]=u}(dsgame,"GameStatistics",dsgame.Event);