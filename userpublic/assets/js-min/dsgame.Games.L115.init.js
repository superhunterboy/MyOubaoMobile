$(function(){dsgame.Games.L115.getInstance({jsNameSpace:"dsgame.Games.L115."}),dsgame.GameTypes.getInstance(),dsgame.GameStatistics.getInstance(),dsgame.GameOrder.getInstance(),dsgame.GameTrace.getInstance(),dsgame.GameSubmit.getInstance(),dsgame.Games.L115.Message.getInstance();var e,t,n=dsgame.Games,r=n.getCurrentGame().getGameConfig().getInstance(),a=r,i=r.getCurrentGameNumber(),s=!0,o=new dsgame.Tip({cls:"j-ui-tip-alert j-ui-tip-b j-ui-tip-showrule",text:"使用厘模式进行投注，单注注单最小金额为0.02元"}),m=(new dsgame.MiniWindow({cls:"lottery-board-pop",effectShow:function(){var e=this;e.dom.css({display:"block",left:"50%",marginLeft:-e.dom.outerWidth()/2,top:2*-e.dom.outerHeight()}).animate({top:206})},effectHide:function(){var e=this;e.dom.animate({top:2*-e.dom.outerHeight()},function(){e.dom.hide()})}}),["00","01","02","03","04","05","06","07","08","09","10","11"]),u=64,d=function(e,n){var r=$("#lottery-numbers-board");$("#J-ernie-issue").html(e),n&&n.length?(t||(r.find("[data-lottery-ernie-numbers]").replaceWith(c(n.length)),t=new dsgame.Ernie({dom:r.find("li"),height:u,length:m.length,callback:g})),$("#J-lottery-ernie-numbers").show(),$(".J-loading-lottery").hide(),t.start(),t.stop(n)):($("#J-lottery-ernie-numbers").hide(),$(".J-loading-lottery").show())},g=function(){i=r.getCurrentGameNumber()},c=function(e){for(var t=['<ul style="display:none;" id="J-lottery-ernie-numbers" class="lottery-ernie-numbers lottery-ernie-numbers-'+e+'">'],n=0;e>n;n++){var r="<li>";$.each(m,function(e,t){r+="<span>"+t+"</span>"}),r+="</li>",t.push(r)}return t.push("</ul>"),t.join("")},l=function(){s&&(i=r.getLastGameNumber(),s=!1),$.ajax({url:r.getLoadIssueUrl(),dataType:"JSON",success:function(t){t.last_number.issue-i>0&&(i=t.last_number.issue),t.last_number.issue==i?(e.stop(),a=t,d(t.last_number.issue,(""+t.last_number.wn_number).split(" ")),a.issues[0].issue==a.last_number.issue&&""==a.issues[0].wn_number&&(a.issues[0].wn_number=a.last_number.wn_number),gameConfigData.issueHistory.issues=a.issues,n.getCurrentGame().getCurrentGameMethod().miniTrend_updateTrend()):d(i)}})},f=function(){var e,t,a=r.getCurrentLastTime(),i=r.getCurrentTime(),s=a-i,o=""+r.getCurrentGameNumber(),m=$(".J-lottery-countdown li em"),u=$("#J-trace-statistics-countdown"),d=n.getCurrentGameMessage();t=function(){if(0>s)return e.stop(),void n.getCurrentGame().getServerDynamicConfig(function(){var e,t=""+r.getCurrentGameNumber(),a=2;d.hide(),n.getCurrentGameTrace().autoDeleteTrace(),n.getCurrentGameTrace().hide(),o!=t&&(d.showTip('<div class="tipdom-cont">当前已进入第<div class="row" style="color:#F60;font-size:18px;">'+t+' 期</div><div class="row">请留意期号变化 (<span id="J-gamenumber-change-s-num">3</span>)</div></div>'),e=setInterval(function(){$("#J-gamenumber-change-s-num").text(a),a-=1,-1>a&&(clearInterval(e),d.hideTip())},1e3))});var t=[],a=Math.floor(s/3600),i=Math.floor(s%3600/60),g=s%3600%60;a=10>a?"0"+a:""+a,i=10>i?"0"+i:""+i,g=10>g?"0"+g:""+g,t.push(a),t.push(i),t.push(g),m.each(function(e){$(this).text(t[e])}),u.html(t.join(":")),s--},e=new dsgame.Timer({time:1e3,fn:t}),$("#J-header-currentNumber").html(o)},h=function(){$("div.game-record-section>ul>li").click(function(){var e=$(this);$("div.game-record-section>ul>li").removeClass("current"),e.addClass("current"),$("#record-iframe").attr("src",e.attr("srclink"))})},C=function(){var t=a.last_number?a.last_number.issue:a.getLastGameNumber(),n=a.last_number?(""+a.last_number.wn_number).split(" "):(""+a.getLotteryBalls()).split(" ");return""==a.getLotteryBalls()?e=new dsgame.Timer({time:5e3,isNew:!0,fn:l}):d(t,n),!1};f(),h(),C(),n.getCurrentGame().addEvent("changeDynamicConfig",function(){e=new dsgame.Timer({time:5e3,isNew:!0,fn:l}),f()}),n.getCurrentGameTypes().addEvent("beforeChange",function(e,t){var r,a=$("#J-panel-gameTypes li"),i=$("#J-gametyes-menu-panel"),s=i.find('[data-id="'+t+'"]'),o=(n.getCurrentGame().getGameConfig().getInstance().getMethodCnNameById(t),"current");s.size()>0&&(i.find("dd").removeClass(o).end(),s.addClass(o),r=s.parents("li").addClass("current").show(),a.removeClass("current").eq(r.index()).addClass("current"))});var b=new dsgame.Tip({cls:"j-ui-tip-b j-ui-tip-showrule"});$("#J-balls-main-panel").on("mouseover",".pick-rule, .win-info",function(){var e=$(this),t=n.getCurrentGame().getCurrentGameMethod().getId(),r=n.getCurrentGame().getGameConfig().getInstance().getMethodById(t),a=e.hasClass("pick-rule")?r.bet_note:r.bonus_note;b.setText(a),b.show(b.getDom().width()/2*-1+e.width()/2,-1*b.getDom().height()-20,e)}),$("#J-balls-main-panel").on("mouseleave",".pick-rule, .win-info",function(){b.hide()}),$("#J-balls-main-panel").on("click",".pick-rule, .win-info",function(){return!1});var G=0;n.getCurrentGame().addEvent("afterSwitchGameMethod",function(e,t){var t=n.getCurrentGame().getCurrentGameMethod().getId(),r=n.getCurrentGameStatistics().getMoneyUnit(),a=n.getCurrentGame().getGameConfig().getInstance().getLimitByMethodId(t,r),i=n.getCurrentGame().getGameConfig().getInstance().getPrizeById(t),s=n.getCurrentGame().getGameConfig().getInstance().getMaxPrizeGroup(),o=n.getCurrentGame().getGameConfig().getInstance().getOptionalPrizes().length,m=n.getCurrentGame().getGameConfig().getInstance().getOptionalPrizes()[o-1].prize_group,u=0,d=!1;G=Number(i.prize),d=i.display_prize,u=m>s?G*r*s/m:G*r,n.getCurrentGameStatistics().getMultipleDom().setMaxValue(a),d?($("#J-method-prize").show(),$("#J-method-prize").find("span").html(dsgame.util.formatMoney(u))):$("#J-method-prize").hide(),n.getCurrentGame().getCurrentGameMethod().miniTrend_updateTrend()}),n.getCurrentGameTypes().addEvent("endShow",function(){this.changeMode(n.getCurrentGame().getGameConfig().getInstance().getDefaultMethodId())}),$("#J-add-order").click(function(){var e=n.getCurrentGameStatistics().getResultData();!e.mid||e.amount<"0.02"||n.getCurrentGameOrder().add(e)}),n.getCurrentGameStatistics().addEvent("afterUpdate",function(e,t,r){var a=this,i=$("#J-add-order"),s=n.getCurrentGame().getGameConfig().getInstance().getMaxPrizeGroup(),m=n.getCurrentGame().getGameConfig().getInstance().getOptionalPrizes().length,u=n.getCurrentGame().getGameConfig().getInstance().getOptionalPrizes()[m-1].prize_group;if(t>0)if(r>="0.02"){i.removeClass("btn-disable");var d=a.getPrizeGroupRate()||0;a.setRebate(r,d),o.hide()}else o.show(o.getDom().width()/2*-1+i.width()/2,-1*o.getDom().height()-20,i),i.addClass("btn-disable"),a.setRebate(0);else i.addClass("btn-disable"),a.setRebate(0),o.hide();var g=G*Number(a.getMoneyUnit());u>s&&(g=G*Number(a.getMoneyUnit())*s/u),$("#J-method-prize").find("span").html(dsgame.util.formatMoney(g))});var p,v=$("#J-panel-order-list-cont");v.jScrollPane(),p=v.data("jsp"),n.getCurrentGameOrder().addEvent("afterChangeLotterysNum",function(e,t){var n=$("#J-submit-order"),r=$("#J-trace-switch"),a=e.data.orderData,i=!1,s=$(".J-cart-empty");if(t>0){for(var o=0;o<a.length;o++).001==a[o].moneyUnit?i=!0:"";i?(n.removeClass("btn-bet-disable"),r.addClass("btn-bet-disable")):n.add(r).removeClass("btn-bet-disable"),s.hide(),p.reinitialise()}else n.add(r).addClass("btn-bet-disable"),s.show()}),$("body").on("click",".remove-error",function(){n.getCurrentGame().getCurrentGameMethod().removeOrderError()}).on("click",".remove-same",function(){n.getCurrentGame().getCurrentGameMethod().removeOrderSame()}).on("click",".remove-all",function(){n.getCurrentGame().getCurrentGameMethod().removeOrderAll()}),n.getCurrentGameStatistics().setMultiple(n.getCurrentGame().getGameConfig().getInstance().getDefaultMultiple()),n.getCurrentGameStatistics().setMoneyUnitDom(n.getCurrentGame().getGameConfig().getInstance().getDefaultCoefficient()),$("body").on("click","#J-submit-order",function(){n.getCurrentGameTrace().deleteTrace(),n.getCurrentGameSubmit().submitData()}),$("#J-trace-switch").click(function(){for(var e=n.getCurrentGameOrder().orderData,t=!1,r=0;r<e.length;r++)"0.001"==e[r].moneyUnit?t=!0:"";return t?!1:($("#J-trace-statistics-balance").html($("[data-user-account-balance]").html()),n.getCurrentGameTrace().show(),!1)}),$("#J-trace-panel").on("click",".closeBtn",function(){n.getCurrentGameTrace().hide(),n.getCurrentGameTrace().deleteTrace()}),$("#J-button-trace-confirm").click(function(){n.getCurrentGameTrace().getIsTrace()&&(n.getCurrentGameTrace().hide(),n.getCurrentGameSubmit().submitData(),n.getCurrentGameTrace().deleteTrace())}),n.getCurrentGameSubmit().addEvent("beforeSend",function(e,t){{var n=t.win.dom.find(".pop-control"),r=n.find("a.confirm");n.find("a.cancel")}r.addClass("btn-disabled"),r.text("提交中..."),t.win.hideCancelButton()}),n.getCurrentGameSubmit().addEvent("afterSubmit",function(e,t){{var n=t.win.dom.find(".pop-control"),r=n.find("a.confirm");n.find("a.cancel")}r.removeClass("btn-disabled"),r.text("确 认"),$("#record-iframe").attr("src",$(".game-record-section >ul.tabs >li.current").attr("srclink")),$("[data-refresh-balance]:eq(0)").trigger("click")}),setTimeout(function(){$("html,body").animate({scrollTop:140},400)},1e3)});