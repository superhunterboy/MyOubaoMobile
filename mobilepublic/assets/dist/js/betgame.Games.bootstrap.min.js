/*‮*/$(function(){betgame.Games[GAMENAMESPACE].getInstance({jsNameSpace:"betgame.Games."+GAMENAMESPACE+"."}),betgame.GameTypes.getInstance(),betgame.GameStatistics.getInstance(),betgame.GameOrder.getInstance(),betgame.GameTrace.getInstance(),betgame.GameSubmit.getInstance(),betgame.Games[GAMENAMESPACE].Message.getInstance();var e=function(){var e=$(".ball-select-panel"),t=$("#section"),a=0;$(window).height();e.siblings().each(function(){a+=parseFloat($(this).outerHeight())}),e.height(parseFloat(t.height())-a);var n=$(".cart-panel"),r=$(window).height(),o=n.find(".top-nav").outerHeight(),s=n.find(".statistics-panel").outerHeight(),i=n.find(".cart-top").outerHeight(),d=n.find(".cart-bottom").outerHeight(),m=n.find(".cart-inner"),g=parseFloat(m.css("padding-top"))+parseFloat(m.css("padding-bottom"))+parseFloat(m.css("border-top-width"))+parseFloat(m.css("border-bottom-width"));$(".cart-content").height(r-o-s-i+45),m.height(r-o-s-i-d-g)};e();var t=betgame.Games,a=t.getCurrentGame().getGameConfig().getInstance(),n=$("#J-gametyes-menu-panel"),r=($("#J-panel-gameTypes"),"selected"),o=$(".game-method-choosed"),s=$("#topGameMethodName");t.getCurrentGameTypes().addEvent("beforeChange",function(e,t){var a=n.find('[data-id="'+t+'"]');a.length&&(n.find("."+r).removeClass(r),$("#methodModal").modal("hide"),a.addClass(r),s.html(a.data("title")))}),n.on(betgame.touchEvent,".types-item",function(){return!$(this).hasClass(r)&&($(this).parents(".game-method-list:eq(0)").find("."+r).removeClass(r),void $(this).addClass(r))}),t.getCurrentGameTypes().addEvent("endShow",function(){this.changeMode(t.getCurrentGame().getGameConfig().getInstance().getDefaultMethodId())}),t.getCurrentGame().addEvent("afterSwitchGameMethod",function(e,a){t.getCurrentGame().getCurrentGameMethod().miniTrend_updateTrend()});var i=$("[data-button-choose]"),d=$("[data-button-fast-submit]"),m=$("[data-button-submit]"),g=$("[data-order-clear]"),l=$("[data-order-empty]"),c=function(){$(".main-page").addClass("ds-hide"),$(".cart-panel").addClass("ds-show")},u=function(){$(".main-page").removeClass("ds-hide"),$(".cart-panel").removeClass("ds-show")};showTrace=function(){$(".cart-panel").addClass("ds-hide"),$(".trace-panel").addClass("ds-show")},hideTrace=function(){$(".cart-panel").removeClass("ds-hide"),$(".trace-panel").removeClass("ds-show"),t.getCurrentGameTrace().deleteTrace(),t.getCurrentGameTrace().reSetTab()},$(".cart-panel").find(".action-back").on(betgame.touchEvent,function(){u()}),$(".trace-panel").find(".action-back").on(betgame.touchEvent,function(){hideTrace()}),$("#J-advance-trace").on(betgame.touchEvent,function(){showTrace()}),$(".cart-top button").on(betgame.touchEvent,function(){var e=$(this).data("action");return"randomone"==e?t.getCurrentGame().getCurrentGameMethod().randomLotterys(1):"randomfive"==e?t.getCurrentGame().getCurrentGameMethod().randomLotterys(5):"back"==e&&u(),!1}),i.on(betgame.touchEvent,function(){var e=t.getCurrentGameStatistics().getResultData();!e.mid||e.amount<"0.02"||(t.getCurrentGameOrder().add(e),c())}),d.on(betgame.touchEvent,function(e){e.preventDefault(),t.getCurrentGame().getCurrentGameMethod().filterOrder&&(t.getCurrentGame().getCurrentGameMethod().filterOrder("hide"),t.getCurrentGame().getCurrentGameMethod().updateData());var a=t.getCurrentGameStatistics().getResultData();!a.mid||a.amount<"0.02"||t.getCurrentGameOrder().fastOrder(a)}),m.on(betgame.touchEvent,function(e){e.preventDefault(),t.getCurrentGameSubmit().submitData()}),t.getCurrentGameOrder().addEvent("afterChangeLotterysNum",function(e,t){t>0?(m.removeClass("disabled"),g.show(),l.hide(),c()):(m.addClass("disabled"),g.hide(),l.show(),u())}),g.on(betgame.touchEvent,function(){t.getCurrentGameOrder().reSet().cancelSelectOrder(),t.getCurrentGame().getCurrentGameMethod().reSet()}),t.getCurrentGameStatistics().addEvent("afterUpdate",function(e,t,a){var n=this,r=i.add(d);if(t>0)if(a>="0.02"){var o=n.getPrizeGroupRate()||0;n.setRebate(a,o),r.removeClass("disabled")}else n.setRebate(0),r.addClass("disabled");else n.setRebate(0),r.addClass("disabled")});var h=function(){var e,n,r=a.getCurrentLastTime(),o=a.getCurrentTime(),s=r-o,i=""+a.getCurrentGameNumber(),d=t.getCurrentGameMessage(),m=15;n=function(){if(s<0||m<0)return clearInterval(e),t.getCurrentGame().getServerDynamicConfig(function(){if(s<0){var e,t=""+a.getCurrentGameNumber(),n=3;if(d.hide(),i!=t){var r=d.getDialog();r.setTitle("温馨提示"),r.setMessage('<p>当前已进入第<span class="c-highlight">'+t+' 期</span></p><p>请留意期号变化 (<span data-tip-second-left class="c-highlight">'+n+"</span>)</p>"),r.setButtons([]),r.open(),e=setInterval(function(){n-=1,$("[data-tip-second-left]").text(n),n<=0&&(clearInterval(e),d.getDialog().close())},1e3)}}}),void(m=15);var n,r=Math.floor(s/3600),o=Math.floor(s%3600/60),g=s%3600%60;r=r<10?"0"+r:""+r,o=o<10?"0"+o:""+o,g=g<10?"0"+g:""+g,n=r+":"+o+":"+g,$("[data-countdown]").html(n),s--,m--},e=setInterval(n,1e3),$("[data-current-issue]").html(i)};t.getCurrentGame().addEvent("changeDynamicConfig",function(e,t){h()}),h();var C=t.getCurrentGame().getGameConfig().getInstance();C.getCurrentGameNumber();$("[data-method-instruction]").on(betgame.touchEvent,function(e){var n=t.getCurrentGame().getCurrentGameMethod().getId(),s=a.getMethodById(n),i=s.bet_note,d=s.bonus_note,m=a.getPrizeById(n),g=m.prize,l=m.display_prize,c=t.getCurrentGameStatistics().getMoneyUnit(),u=(a.getLimitByMethodId(n,c),o.find("."+r).text()),h=t.getCurrentGameMessage().getDialog(),C="";C+="<p><label>当前玩法：</label><small>"+u+"</small></p>",l&&(C+='<p><label>单注最高奖金:</label>&nbsp;&nbsp;<small><span class="c-highlight">'+betgame.util.formatMoney(g*c)+"</span>&nbsp;元</small></p>"),C+="<p><label>选号规则：</label><br><small>"+i+"</small></p>",C+="<p><label>中奖说明：</label><br><small>"+d+"</small></p>",h.realize(),h.getModalDialog().addClass("method-instruction-dialog"),h.setTitle("玩法提示"),h.setMessage(C),h.setButtons([{label:"知道了",action:function(e){e.close()}}]),h.open()}),$("body").on("click",".remove-error",function(){t.getCurrentGame().getCurrentGameMethod().removeOrderError()}).on("click",".remove-same",function(){t.getCurrentGame().getCurrentGameMethod().removeOrderSame()}).on("click",".remove-all",function(){t.getCurrentGame().getCurrentGameMethod().removeOrderAll()}),$("#gotoNewGame").on("change",function(){window.location=$(this).val()})});